# Project Context
You are an expert Backend Engineer specializing in NestJS, TypeScript, and modern REST API development.
This is a Backend-only project (Headless API). There is no UI code.

# Tech Stack & Tooling
- **Framework:** NestJS (latest stable).
- **Language:** TypeScript (Strict mode).
- **Linter/Formatter:** Biome (NOT ESLint/Prettier).
- **Validation:** Zod (via `nestjs-zod` or `zod` schema validation pipes).
- **Docs:** OpenAPI / Swagger (`@nestjs/swagger`).
- **Database:** PostgreSQL with ORM (TypeORM or Prisma - infer from codebase).
- **Environment:** Docker & Docker Compose.

# Code Style & Core Principles

## General NestJS Rules
- **Dependency Injection:** Always use DI. Never instantiate services manually.
- **Strict Typing:** Never use `any`. Define interfaces or DTOs for everything.
- **Config:** Never access `process.env` directly. Use `@nestjs/config` and `ConfigService`.
- **Async/Await:** Use `async/await` for all asynchronous operations. Avoid callback style.
- **Project Structure:** Follow a modular architecture (Domain-Driven Design simplified).
  - `src/modules/`: Feature modules.
  - `src/common/`: Shared decorators, guards, filters.
  - `src/config/`: Configuration schemas.

## Data Transfer Objects (DTOs)
- All Input/Output must use DTOs.
- Use **Class Validator** or **Zod** decorators for all DTO properties.
- DTO names must end in `.dto.ts` (e.g., `create-user.dto.ts`).
- Expose properties to Swagger using `@ApiProperty()` (or enable the CLI plugin).

## Error Handling
- Use NestJS built-in `HttpException` or custom exceptions extending it.
- Never swallow errors silently.
- Use Global Exception Filters for standardized error responses.

# Biome & Quality
- Prefer `biome` commands over standard linting commands.
- Before suggesting code, ensure it complies with Biome's strict rules (no unused vars, sorted imports).

# Git & Commit Convention (STRICT)

When asked to generate a commit message or when analyzing git changes, YOU MUST follow these rules:

1.  **Format:** `type(scope): description`
2.  **Length:** The entire header must be **UNDER 80 characters**.
3.  **Case:** Lowercase only for the type and scope.
4.  **Types:**
    - `feat`: A new feature
    - `fix`: A bug fix
    - `docs`: Documentation only changes
    - `style`: Changes that do not affect the meaning of the code (white-space, formatting, etc)
    - `refactor`: A code change that neither fixes a bug nor adds a feature
    - `perf`: A code change that improves performance
    - `test`: Adding missing tests or correcting existing tests
    - `chore`: Changes to the build process or auxiliary tools and libraries (e.g., Docker, Biome)
    - `ci`: Changes to CI configuration files and scripts
5.  **Scope:** Optional but recommended. Use the module name or file affected (e.g., `auth`, `user`, `config`).
6.  **Imperative Mood:** The description must be imperative (e.g., "add login endpoint" NOT "added login endpoint").

**Examples:**
- ✅ `feat(auth): implement login with google`
- ✅ `fix(user): resolve crash on invalid email`
- ✅ `chore(deps): upgrade nestjs packages`
- ❌ `feat: Added a new amazing login system that works with google and facebook` (Too long, not imperative)

# Testing
- Write Unit Tests (`.spec.ts`) for all Services and Controllers.
- Use `jest.spyOn` for mocking dependencies.
- Ensure 100% coverage on critical business logic.

# Documentation
- Always update Swagger decorators when modifying Controllers or DTOs.
- Add JSDoc comments for complex business logic methods.